.headless-component-tests:
  extends: .fast-tests
  image: ${IMAGE_JS_PAYMENTS_TESTS}
  variables:
    BEHAVE_LOGGING_LEVEL: INFO
    FEATURE_FILE: '' # To be set up
  services:
    - name: "${IMAGE_JS_PAYMENTS_APP_HTML_TEST}"
      alias: library.securetrading.net
    - name: "${IMAGE_JS_PAYMENTS_APP_HTML_TEST}"
      alias: merchant.securetrading.net
    - name: "${IMAGE_JS_PAYMENTS_WIREMOCK}"
      alias: webservices.securetrading.net
      command: ["--https-port", "8443", "--https-keystore", "/home/wiremock/keystore"]
    - name: "${IMAGE_JS_PAYMENTS_WIREMOCK}"
      alias: thirdparty.example.com
      command: ["--https-port", "8443", "--https-keystore", "/home/wiremock/keystore"]
  script:
    - . .cicd_scripts/tests/headless_component.sh
    - cd "${PROJECT_JS_PAYMENTS_TESTS_NAME}"
    - python3 -m venv venv
    - . venv/bin/activate
    - poetry install
    - execute_headless_component_test "${BEHAVE_LOGGING_LEVEL}" "${FEATURE_FILE}"

card-payments-headless-component-tests:
  extends: .headless-component-tests
  variables:
    FEATURE_FILE: 'card_payments_tests.feature'

visa-checkout-headless-component-tests:
  extends: .headless-component-tests
  variables:
    FEATURE_FILE: 'visa_checkout_tests.feature'
